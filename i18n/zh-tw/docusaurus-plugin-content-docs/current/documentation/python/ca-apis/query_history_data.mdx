---
sidebar_position: 7
sidebar_label: query_history_data
hide_title: true
---

import { Highlight } from "../../../../../../../src/components/Highlight.js";

# query_history_data

可在 `__init__` 函數中取得過去 `length` 個週期為 `period` 的歷史資料，以便執行策略當下即可計算相關參數（例如 MA）。
呼叫後請儲存結果，CA.query_history_data 僅可呼叫一次。

## Input

```
  length: number;
  period: number;
```

## Output

```
  error: string;
  candles: dictionary;
```

## 範例

```python
def __init__(self):

    self.subscribed_books = {
        'Binance': {
            'pairs': ['BTC-USDT'],
        },
    }
    self.period = 60 * 60  # 1 hour

    # query the past 7 days data
    self.history_data = CA.query_history_data(168, self.period)

    if self.history_data:
        exchange = list(self.history_data['candles'])[0]
        pair = list(self.history_data['candles'][exchange])[0]
        high_list = np.array([])
        for candles in self.history_data['candles'][exchange][pair]:
            CA.log('history high: ' + str(candles['high']))
            high_list = np.append(high_list, [float(candles['high'])])
```
